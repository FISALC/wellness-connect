import{b as j,a as g,c as f,r as i,j as e}from"./index-CeZ1v-29.js";import{u as v}from"./useQuery-BG1UA43B.js";import{u as y,a as N,b as w}from"./admins.api-CO7NjTbF.js";import"./api-Bbb2V7Rn.js";function q(){const{id:t}=j(),o=g(),m=f(),[a,d]=i.useState({username:"",email:"",password:"",role:"Admin"}),[u,c]=i.useState(null),{data:r,isLoading:x,isError:b}=v({queryKey:["admin",t],queryFn:()=>w(t),enabled:!!t});i.useEffect(()=>{r&&d({username:r.username,email:r.email,password:"",role:r.role})},[r]);const l=y({mutationFn:s=>N(t,s),onSuccess:()=>{m.invalidateQueries({queryKey:["admins"]}),m.invalidateQueries({queryKey:["admin",t]}),alert("Admin updated successfully"),o("/admin/users")},onError:s=>{var n,p;console.error(s),c(((p=(n=s==null?void 0:s.response)==null?void 0:n.data)==null?void 0:p.message)||"Failed to update admin")}}),h=s=>{s.preventDefault(),c(null);const n={username:a.username,email:a.email,role:a.role};a.password&&(n.password=a.password),l.mutate(n)};return x?e.jsx("div",{className:"p-6",children:"Loading..."}):b?e.jsx("div",{className:"p-6 text-red-500",children:"Failed to load admin details."}):e.jsxs("section",{className:"max-w-2xl space-y-6",children:[e.jsxs("header",{children:[e.jsx("h1",{className:"text-xl font-semibold",children:"Edit Admin"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Update admin user details."})]}),u&&e.jsx("div",{className:"p-3 bg-red-50 text-red-700 rounded-md text-sm border border-red-200",children:u}),e.jsx("div",{className:"rounded-lg border bg-white p-6",children:e.jsxs("form",{onSubmit:h,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Username"}),e.jsx("input",{required:!0,className:"w-full rounded-md border px-3 py-2 text-sm",value:a.username,onChange:s=>d({...a,username:s.target.value}),placeholder:"e.g. jdoe"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Email"}),e.jsx("input",{required:!0,type:"email",className:"w-full rounded-md border px-3 py-2 text-sm",value:a.email,onChange:s=>d({...a,email:s.target.value}),placeholder:"e.g. jdoe@example.com"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["Password ",e.jsx("span",{className:"text-gray-400 font-normal",children:"(Leave blank to keep current)"})]}),e.jsx("input",{type:"password",className:"w-full rounded-md border px-3 py-2 text-sm",value:a.password,onChange:s=>d({...a,password:s.target.value}),placeholder:"••••••••"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Role"}),e.jsxs("select",{className:"w-full rounded-md border px-3 py-2 text-sm bg-white",value:a.role,onChange:s=>d({...a,role:s.target.value}),children:[e.jsx("option",{value:"Admin",children:"Admin"}),e.jsx("option",{value:"SuperAdmin",children:"SuperAdmin"}),e.jsx("option",{value:"Editor",children:"Editor"})]})]}),e.jsxs("div",{className:"pt-4 flex gap-3",children:[e.jsx("button",{type:"submit",disabled:l.isPending,className:"rounded-md bg-gray-900 text-white px-4 py-2 text-sm font-medium hover:bg-black disabled:opacity-70",children:l.isPending?"Updating...":"Update Admin"}),e.jsx("button",{type:"button",onClick:()=>o("/admin/users"),className:"rounded-md border px-4 py-2 text-sm font-medium hover:bg-gray-50",children:"Cancel"})]})]})})]})}export{q as default};
