import{a as T,r as l,j as e,L as S}from"./index-CeZ1v-29.js";import{u as $}from"./useProducts-CjhdhED1.js";import"./products.api-CsF4ySjT.js";import"./api-Bbb2V7Rn.js";const C={0:"Protein",1:"Vitamins",2:"Apparel",3:"Healthy Eats",4:"Accessories"};function q(){const o=T(),{data:a,isLoading:x,isError:b}=$(),[m,A]=l.useState(""),[j,M]=l.useState("all"),[c,P]=l.useState("created"),[h,w]=l.useState("desc"),[s,n]=l.useState(1),u=10,L=l.useMemo(()=>[...(a??[]).filter(r=>{var f;const i=!m||r.name.toLowerCase().includes(m.toLowerCase())||((f=C[r.category])==null?void 0:f.toLowerCase().includes(m.toLowerCase())),p=j==="all"?!0:r.category===j;return i&&p})].sort((r,i)=>{const p=h==="asc"?1:-1;if(c==="name")return r.name.localeCompare(i.name)*p;if(c==="category")return(r.category-i.category)*p;const f=r.createdAt?Date.parse(r.createdAt):0,B=i.createdAt?Date.parse(i.createdAt):0;return(f-B)*p}),[a,m,j,c,h]),y=L.length,d=Math.max(1,Math.ceil(y/u));l.useEffect(()=>{s>d&&n(d)},[d,s]);const E=L.slice((s-1)*u,s*u),v=t=>{c===t?w(N=>N==="asc"?"desc":"asc"):(P(t),w("asc"))};if(x)return e.jsxs("section",{className:"p-6 space-y-4",children:[e.jsx(D,{}),e.jsx("div",{className:"rounded-lg border bg-white p-4",children:e.jsx(H,{rows:6})})]});if(b)return e.jsx("p",{className:"p-6 text-red-600",children:"Failed to load products."});return e.jsxs("section",{className:"p-6 space-y-4",children:[e.jsx(D,{}),e.jsxs("div",{className:"rounded-lg border bg-white p-4 flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{className:"flex gap-2 flex-1",children:[e.jsx("input",{value:m,onChange:t=>{A(t.target.value),n(1)},placeholder:"Search by name or category…",className:"w-full md:w-72 rounded-md border px-3 py-2 text-sm"}),e.jsxs("select",{value:j,onChange:t=>{M(t.target.value==="all"?"all":Number(t.target.value)),n(1)},className:"rounded-md border px-3 py-2 text-sm bg-white",children:[e.jsx("option",{value:"all",children:"All categories"}),Object.entries(C).map(([t,N])=>e.jsx("option",{value:t,children:N},t))]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{A(""),M("all"),P("created"),w("desc"),n(1)},className:"rounded-md border px-3 py-2 text-sm hover:bg-gray-50",children:"Reset"}),e.jsx(S,{to:"/admin/products/new",className:"rounded-md bg-gray-900 text-white px-3 py-2 text-sm",children:"+ New Product"})]})]}),y===0?e.jsx(z,{}):e.jsxs("div",{className:"rounded-lg border bg-white overflow-x-auto",children:[e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx(g,{onClick:()=>v("name"),active:c==="name",dir:h,children:"Name"}),e.jsx(g,{children:"Preview"}),e.jsx(g,{onClick:()=>v("category"),active:c==="category",dir:h,children:"Category"}),e.jsx(g,{children:"New?"}),e.jsx(g,{onClick:()=>v("created"),active:c==="created",dir:h,children:"Created"}),e.jsx("th",{className:"px-3 py-2 text-right",children:"Actions"})]})}),e.jsx("tbody",{children:E.map(t=>e.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[e.jsx("td",{className:"px-3 py-2 font-medium",children:t.name}),e.jsx("td",{className:"px-3 py-2",children:t.imageUrl?e.jsx("img",{src:t.imageUrl,alt:t.name,className:"h-10 w-10 rounded object-cover border"}):e.jsx("div",{className:"h-10 w-10 rounded border grid place-items-center text-xs text-gray-400",children:"—"})}),e.jsx("td",{className:"px-3 py-2",children:C[t.category]??t.category}),e.jsx("td",{className:"px-3 py-2",children:e.jsx("span",{className:`inline-flex items-center rounded px-2 py-0.5 text-xs
                      ${t.isNew?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:t.isNew?"New":"—"})}),e.jsx("td",{className:"px-3 py-2 text-gray-500",children:t.createdAt?new Date(t.createdAt).toLocaleDateString():"—"}),e.jsx("td",{className:"px-3 py-2",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{className:"rounded-md border px-2 py-1 hover:bg-gray-50",onClick:()=>o(`/admin/products/${t.id}/edit`),children:"Edit"}),e.jsx("button",{className:"rounded-md border px-2 py-1 hover:bg-red-50 text-red-600",onClick:()=>k(t),children:"Delete"})]})})]},t.id))})]}),e.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-t text-sm",children:[e.jsxs("span",{className:"text-gray-600",children:["Showing ",(s-1)*u+1,"–",Math.min(s*u,y)," of ",y]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"rounded-md border px-2 py-1 disabled:opacity-50",onClick:()=>n(t=>Math.max(1,t-1)),disabled:s===1,children:"Prev"}),e.jsxs("span",{className:"min-w-[3rem] text-center",children:[s,"/",d]}),e.jsx("button",{className:"rounded-md border px-2 py-1 disabled:opacity-50",onClick:()=>n(t=>Math.min(d,t+1)),disabled:s===d,children:"Next"})]})]})]})]});function k(t){confirm(`Delete "${t.name}"?`)&&alert("Delete API not wired yet.")}}function D(){return e.jsxs("div",{className:"mb-1 flex items-center justify-between",children:[e.jsx("h1",{className:"text-xl font-semibold",children:"Products"}),e.jsx(S,{to:"/admin/products/new",className:"rounded-md bg-gray-900 text-white px-3 py-1.5 text-sm",children:"+ New"})]})}function g({children:o,onClick:a,active:x,dir:b}){return e.jsx("th",{onClick:a,className:`px-3 py-2 text-left select-none ${a?"cursor-pointer":""}`,title:a?"Sort":void 0,children:e.jsxs("span",{className:"inline-flex items-center gap-1",children:[o,x&&e.jsx("svg",{viewBox:"0 0 20 20",className:"h-3 w-3 text-gray-500",children:b==="asc"?e.jsx("path",{d:"M10 6l-4 6h8l-4-6z",fill:"currentColor"}):e.jsx("path",{d:"M10 14l4-6H6l4 6z",fill:"currentColor"})})]})})}function z(){return e.jsxs("div",{className:"rounded-lg border bg-white p-8 text-center",children:[e.jsx("div",{className:"mx-auto mb-4 h-16 w-16 rounded-full bg-gray-100 grid place-items-center",children:e.jsx("svg",{viewBox:"0 0 24 24",className:"h-7 w-7 text-gray-400",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:e.jsx("path",{d:"M3 7h18M3 7v10a2 2 0 002 2h14a2 2 0 002-2V7M7 7v10m10-10v10M9 11h6"})})}),e.jsx("h3",{className:"text-lg font-semibold",children:"No products yet"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Create your first product to get started."}),e.jsx(S,{to:"/admin/products/new",className:"inline-flex mt-4 rounded-md bg-gray-900 text-white px-3 py-1.5 text-sm",children:"+ Create Product"})]})}function H({rows:o=6}){return e.jsx("div",{className:"animate-pulse space-y-2",children:[...Array(o)].map((a,x)=>e.jsx("div",{className:"h-9 w-full bg-gray-100 rounded"},x))})}export{q as default};
